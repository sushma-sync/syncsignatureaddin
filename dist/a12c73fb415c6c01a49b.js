var _display_name,_job_title,_phone_number,_email_id,_greeting_text,_preferred_pronoun,_message;function on_initialization_complete(){$(document).ready((function(){_output=$("textarea#output"),_display_name=$("input#display_name"),_email_id=$("input#email_id"),_job_title=$("input#job_title"),_phone_number=$("input#phone_number"),_greeting_text=$("input#greeting_text"),_preferred_pronoun=$("input#preferred_pronoun"),_message=$("p#message"),prepopulate_from_userprofile(),load_saved_user_info()}))}function prepopulate_from_userprofile(){_display_name.val(Office.context.mailbox.userProfile.displayName),_email_id.val(Office.context.mailbox.userProfile.emailAddress)}function load_saved_user_info(){var e=localStorage.getItem("user_info");if(e||(e=Office.context.roamingSettings.get("user_info")),e){var a=JSON.parse(e);_display_name.val(a.name),_email_id.val(a.email),_job_title.val(a.job),_phone_number.val(a.phone),_greeting_text.val(a.greeting);var t=a.pronoun;t&&t.length>=3&&_preferred_pronoun.val(t.substring(1,t.length-1))}}function display_message(e){_message.text(e)}function clear_message(){_message.text("")}function is_not_valid_text(e){return e.length<=0}function is_not_valid_email_address(e){return is_not_valid_text(e)||!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e)}function form_has_valid_data(e,a){return is_not_valid_text(e)?(display_message("Please enter a valid name."),!1):!is_not_valid_email_address(a)||(display_message("Please enter a valid email address."),!1)}function navigate_to_taskpane_assignsignature(){window.location.href="assignsignature.html"}function create_user_info(){var e=_display_name.val().trim(),a=_email_id.val().trim();if(clear_message(),form_has_valid_data(e,a)){clear_message();var t={};t.name=e,t.email=a,t.job=_job_title.val().trim(),t.phone=_phone_number.val().trim(),t.greeting=_greeting_text.val().trim(),t.pronoun=_preferred_pronoun.val().trim(),""!==t.pronoun&&(t.pronoun="("+t.pronoun+")"),console.log(t),localStorage.setItem("user_info",JSON.stringify(t)),navigate_to_taskpane_assignsignature()}}function clear_all_fields(){_display_name.val(""),_email_id.val(""),_job_title.val(""),_phone_number.val(""),_greeting_text.val(""),_preferred_pronoun.val("")}function clear_all_localstorage_data(){localStorage.removeItem("user_info"),localStorage.removeItem("newMail"),localStorage.removeItem("reply"),localStorage.removeItem("forward"),localStorage.removeItem("override_olk_signature")}function clear_roaming_settings(){Office.context.roamingSettings.remove("user_info"),Office.context.roamingSettings.remove("newMail"),Office.context.roamingSettings.remove("reply"),Office.context.roamingSettings.remove("forward"),Office.context.roamingSettings.remove("override_olk_signature"),Office.context.roamingSettings.saveAsync((function(e){console.log("clear_roaming_settings - "+JSON.stringify(e));var a="All settings reset successfully! This add-in won't insert any signatures. You can close this pane now.";e.status===Office.AsyncResultStatus.Failed&&(a="Failed to reset. Please try again."),display_message(a)}))}function reset_all_configuration(){clear_all_fields(),clear_all_localstorage_data(),clear_roaming_settings()}Office.initialize=function(e){on_initialization_complete()};