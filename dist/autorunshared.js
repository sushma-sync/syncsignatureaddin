function checkSignature(e){let t=Office.context.roamingSettings.get("user_info");if(t){let n=JSON.parse(t);Office.context.mailbox.item.getComposeTypeAsync?Office.context.mailbox.item.getComposeTypeAsync({asyncContext:{user_info:n,eventObj:e}},(function(e){"succeeded"===e.status&&insert_auto_signature(e.value.composeType,e.asyncContext.user_info,e.asyncContext.eventObj)})):insert_auto_signature("newMail",JSON.parse(t),e)}else display_insight_infobar()}function insert_auto_signature(e,t,n){addTemplateSignature(get_signature_info(get_template_name(e),t),n)}function addTemplateSignature(e,t,n){!0===is_valid_data(e.logoBase64)?Office.context.mailbox.item.addFileAttachmentFromBase64Async(e.logoBase64,e.logoFileName,{isInline:!0},(function(n){Office.context.mailbox.item.body.setSignatureAsync(e.signature,{coercionType:"html",asyncContext:t},(function(e){e.asyncContext.completed()}))})):Office.context.mailbox.item.body.setSignatureAsync(e.signature,{coercionType:"html",asyncContext:t},(function(e){e.asyncContext.completed()}))}function display_insight_infobar(){Office.context.mailbox.item.notificationMessages.addAsync("fd90eb33431b46f58a68720c36154b4a",{type:"insightMessage",message:"Please set your signature with the Office Add-ins sample.",icon:"Icon.16x16",actions:[{actionType:"showTaskPane",actionText:"Set signatures",commandId:get_command_id(),contextData:"{''}"}]})}function get_template_name(e){return"reply"===e?Office.context.roamingSettings.get("reply"):"forward"===e?Office.context.roamingSettings.get("forward"):Office.context.roamingSettings.get("newMail")}function get_signature_info(e,t){return"templateB"===e?get_template_B_info(t):"templateC"===e?get_template_C_info(t):get_template_A_info(t)}function get_command_id(){return"appointment"==Office.context.mailbox.item.itemType?"MRCS_TpBtn1":"MRCS_TpBtn0"}function get_template_A_info(e){const t="sample-logo.png";let n="";return is_valid_data(e.greeting)&&(n+=e.greeting+"<br/>"),n+="<table>",n+="<tr>",n+="<td style='border-right: 1px solid #000000; padding-right: 5px;'><img src='cid:"+t+"' alt='MS Logo' width='24' height='24' /></td>",n+="<td style='padding-left: 5px;'>",n+="<strong>"+e.name+"</strong>",n+=is_valid_data(e.pronoun)?"&nbsp;"+e.pronoun:"",n+="<br/>",n+=is_valid_data(e.job)?e.job+"<br/>":"",n+=e.email+"<br/>",n+=is_valid_data(e.phone)?e.phone+"<br/>":"",n+="</td>",n+="</tr>",n+="</table>",{signature:n,logoBase64:"iVBORw0KGgoAAAANSUhEUgAAACIAAAAiCAYAAAA6RwvCAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAEeSURBVFhHzdhBEoIwDIVh4EoeQJd6YrceQM+kvo5hQNokLymO/4aF0/ajlBl1fL4bEp0uj3K9XQ/lGi0MEcB3UdD0uVK1EEj7TIuGeBaKYCgIswCLcUMid8mMcUEiCMk71oRYE+Etsd4UD0aFeBBSFtOEMAgpg6lCIggpitlAMggpgllBeiAkFjNDeiIkBlMgeyAkL6Z6WJdlEJJnjvF4vje/BvRALNN23tyRXzVpd22dHSZtLhjMHemB8cxRINZZyGCssbL2vCN7YLwItHo0PTEMAm3OSA8Mi0DVw5rBRBCoCkERTBSBmhDEYDII5PqlZy1iZSGQuiOSZ6JW3rEuCIpgmDFuCGImZuEUBHkWiOweDUHaQhEE+pM/aobhBZaOpYLJeeeoAAAAAElFTkSuQmCC",logoFileName:t}}function get_template_B_info(e){let t="";return is_valid_data(e.greeting)&&(t+=e.greeting+"<br/>"),t+="<table>",t+="<tr>",t+="<td style='border-right: 1px solid #000000; padding-right: 5px;'><img src='https://officedev.github.io/Office-Add-in-samples/Samples/outlook-set-signature/assets/sample-logo.png' alt='Logo' /></td>",t+="<td style='padding-left: 5px;'>",t+="<strong>"+e.name+"</strong>",t+=is_valid_data(e.pronoun)?"&nbsp;"+e.pronoun:"",t+="<br/>",t+=e.email+"<br/>",t+=is_valid_data(e.phone)?e.phone+"<br/>":"",t+="</td>",t+="</tr>",t+="</table>",{signature:t,logoBase64:null,logoFileName:null}}function get_template_C_info(e){let t="";return is_valid_data(e.greeting)&&(t+=e.greeting+"<br/>"),t+=e.name,{signature:t,logoBase64:null,logoFileName:null}}function is_valid_data(e){return null!=e&&""!==e}Office.actions.associate("checkSignature",checkSignature);