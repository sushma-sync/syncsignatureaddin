<!-- Copyright (c) Microsoft Corporation.
     Licensed under the MIT License. -->
     
<!DOCTYPE html>
<html>

<head>
  <title>Signature Data Form</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link href="../CSS/editsignature.css" rel="stylesheet" type="text/css" media="all" />
  <link href="../CSS/assignsignature.css" rel="stylesheet" type="text/css" media="all" />
  <link rel="stylesheet" href="https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css"/>

  <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script type="text/javascript" src="../../utilities.js"></script>
  <script type="text/javascript" src="../Js/taskpane_render.js"></script>  
  <script type="text/javascript" src="../../utilities.js"></script>
  <script type="text/javascript" src="../Js/signature_templates.js"></script>
  <script type="text/javascript" src="../Js/signature_loader.js"></script>
  <script type="text/javascript" src="../Js/taskpane_main.js"></script>
  <script type="text/javascript" src="../Js/signature_selection.js"></script>
</head>

<body>  
  <div class="container">
   
    <h2>Email Signature Configuration</h2>
    
    <!-- Where to set signature section -->
    <div class="signature-selection-section">
      <!-- <h3 class="section-title">Where to set signature</h3> -->
      <p class="section-description">Select the email types where you want to apply your signature</p>
      
      <div class="signature-options">
        <div class="option-card" id="newEmailCard">
          <div class="option-header">
            <input type="checkbox" id="newMailSignature" checked>
            <label for="newMailSignature" class="option-title">New Email</label>
            <span class="checkmark">✓</span>
          </div>
          <p class="option-description">Apply signature to new email messages</p>
        </div>
        
        <div class="option-card" id="replyCard">
          <div class="option-header">
            <input type="checkbox" id="replySignature">
            <label for="replySignature" class="option-title">Reply</label>
            <span class="checkmark">✓</span>
          </div>
          <p class="option-description">Apply signature to reply messages</p>
        </div>
        
        <div class="option-card" id="forwardCard">
          <div class="option-header">
            <input type="checkbox" id="forwardSignature">
            <label for="forwardSignature" class="option-title">Forward</label>
            <span class="checkmark">✓</span>
          </div>
          <p class="option-description">Apply signature to forwarded messages</p>
        </div>
        
        <!-- <div class="option-card" id="overrideCard">
          <div class="option-header">
            <input type="checkbox" id="overrideOutlookSignature">
            <label for="overrideOutlookSignature" class="option-title">Override Outlook Default</label>
            <span class="checkmark">✓</span>
          </div>
          <p class="option-description">Replace Outlook's default signature</p>
        </div> -->
      </div>
    </div>
    
    <!-- Selected signature display section -->
    <!-- <div class="selected-signature-section" id="selectedSignatureSection">
      <h3 class="section-title">Your Selected Configuration</h3>
      <div class="selected-options" id="selectedOptions">
        <div class="selected-item active" id="selectedNewEmail">
          <span class="selected-icon">✓</span>
          <span class="selected-text">New Email</span>
        </div>
      </div>
    </div> -->
    
    <button id="submit_button" type="submit" class="registerbtn" onclick="set_syncsignature()">Set Signature</button>
    
    <!-- Selected signature configuration display -->
    <div id="selectedConfigurationSection" style="display: none; margin-top: 20px; padding: 15px; background-color: #f3f2f1; border-radius: 4px;">
      <h4 style="margin: 0 0 10px 0; color: #323130; font-size: 14px;">Your Selected Configuration:</h4>
      <div id="selectedOptions" style="display: flex; flex-wrap: wrap; gap: 8px;">
        <!-- Selected options will be populated here -->
      </div>
    </div>
    
    <!-- Signin prompt section (shown by default) -->
    <div id="signin_prompt" class="signin-prompt" style="display: block; margin-top: 20px; padding: 20px; border: 1px solid #e0e0e0; border-radius: 4px; text-align: center;">
      <div class="signin-content">
        <h3>Sign In Required</h3>
        <p>Don't have a Syncsignature account? Sign in</p>
        <div style="display: flex; gap: 10px; justify-content: center; margin-top: 15px;">
          <button id="signin_button" class="signin-btn" onclick="openSigninPage()" style="background-color: #0078d4; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer;">Sign In to SyncSignature</button>
          <!-- <button id="retry_button" class="retry-btn" onclick="retryFetchSignature()" style="background-color: #6c757d; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer;">Retry</button> -->
        </div>
      </div>
    </div>
    
    <!-- <div id="dummy_signature" style="margin-top: 20px; padding: 10px; border: 1px solid #ccc;">
    </div> -->
    
    <p id="message" style="display: none; margin-top: 10px; color: #0078d4;"></p>
  </div>

</body>

</html>

